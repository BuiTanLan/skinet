{"version":3,"file":"common.js","mappings":"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","sources":["./src/app/shared/models/pagination.ts","./src/app/shared/models/shopParams.ts","./src/app/shop/shop.service.ts"],"sourcesContent":["import { IProduct } from './product';\r\nexport interface IPagination {\r\n    pageIndex: number;\r\n    pageSize: number;\r\n    count: number;\r\n    data: IProduct[];\r\n}\r\n\r\nexport class Pagination implements IPagination {\r\n    pageIndex = 1;\r\n    pageSize = 6;\r\n    count = 0;\r\n    data: IProduct[] = [];\r\n}\r\n","export class ShopParams implements IShopParams{\r\n  brandName = 'all';\r\n  typeName = 'all';\r\n  sort = 'name';\r\n  pageNumber = 1;\r\n  pageSize = 6;\r\n  search =  '';\r\n}\r\n\r\nexport interface IShopParams {\r\n  brandName: string;\r\n  typeName: string;\r\n  sort: string;\r\n  pageNumber: number;\r\n  pageSize: number;\r\n  search: string;\r\n}\r\n","import { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { IBrand } from '../shared/models/brand';\r\nimport { IPagination, Pagination } from '../shared/models/pagination';\r\nimport { IType } from '../shared/models/type';\r\nimport { map } from 'rxjs/operators';\r\nimport { ShopParams } from '../shared/models/shopParams';\r\nimport { IProduct } from '../shared/models/product';\r\nimport { of } from 'rxjs';\r\nimport { environment } from 'src/environments/environment';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class ShopService {\r\n  baseUrl = environment.apiUrl;\r\n  products: IProduct[] = [];\r\n  brands: IBrand[] = [];\r\n  types: IType[] = [];\r\n  pagination = new Pagination();\r\n  shopParams = new ShopParams();\r\n  productCache = new Map();\r\n\r\n  constructor(private readonly http: HttpClient) { }\r\n  getBrand() {\r\n    if (this.brands.length > 0) {\r\n      return of(this.brands);\r\n    }\r\n    return this.http.get<IBrand[]>(this.baseUrl + 'products/brands').pipe(\r\n      map(response => {\r\n        this.brands = response;\r\n        return response;\r\n      })\r\n    );\r\n  }\r\n  getType() {\r\n    if (this.types.length > 0) {\r\n      return of(this.types);\r\n    }\r\n    return this.http.get<IType[]>(this.baseUrl + 'products/types').pipe(\r\n      map(response => {\r\n        this.types = response;\r\n        return response;\r\n      })\r\n    );\r\n  }\r\n\r\n\r\n  getProduct(id: number) {\r\n    let product: IProduct | undefined;\r\n    this.productCache.forEach((products: IProduct[]) => {\r\n      product = products.find(p => p.id === id);\r\n    });\r\n\r\n    if (product) {\r\n      return of(product);\r\n    } else {\r\n      return this.http.get<IProduct>(this.baseUrl + 'products/' + id);\r\n\r\n    }\r\n  }\r\n\r\n\r\n  getProducts(useCache: boolean) {\r\n    if (!useCache) {\r\n      this.productCache = new Map();\r\n    }\r\n\r\n    if (this.productCache.size > 0 && useCache) {\r\n      if (this.productCache.has(Object.values(this.shopParams).join('-'))) {\r\n        this.pagination.data = this.productCache.get(Object.values(this.shopParams).join('-'));\r\n        return of(this.pagination);\r\n      }\r\n    }\r\n\r\n    let params = new HttpParams();\r\n    if (this.shopParams.brandName) {\r\n      params = params.append('brandName', this.shopParams.brandName);\r\n    }\r\n    if (this.shopParams.typeName) {\r\n      params = params.append('typeName', this.shopParams.typeName);\r\n    }\r\n    if (this.shopParams.search) {\r\n      params = params.append('search', this.shopParams.search);\r\n    }\r\n    params = params.append('sort', this.shopParams.sort);\r\n    params = params.append('pageIndex', this.shopParams.pageNumber.toString());\r\n    params = params.append('pageSize', this.shopParams.pageSize.toString());\r\n    return this.http\r\n      .get<IPagination>(this.baseUrl + 'products', {\r\n        observe: 'response',\r\n        params,\r\n      })\r\n      .pipe(\r\n        map((response) => {\r\n          this.productCache.set(Object.values(this.shopParams).join('-'), response.body?.data);\r\n          this.pagination = response.body ?? {} as IPagination;\r\n          return this.pagination;\r\n        })\r\n      );\r\n  }\r\n\r\n\r\n  setShopParams(params: ShopParams): void {\r\n    this.shopParams = params;\r\n  }\r\n\r\n  getShopParams() {\r\n    return this.shopParams;\r\n  }\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}